def on_overlap_tile(sprite, location):
    global gra
    if controller.A.is_pressed():
        gra = 0 if gra == 1 else 1
        tiles.set_tile_at(location, myTiles.transparency16)
scene.on_overlap_tile(SpriteKind.player, myTiles.tile2, on_overlap_tile)

def on_a_pressed():
    global gra, IsOnWall
    if spider.is_hitting_tile(CollisionDirection.TOP) or spider.is_hitting_tile(CollisionDirection.BOTTOM):
        gra = 0 if gra == 1 else 1
        IsOnWall = 1
        
        def on_after():
            global IsOnWall
            IsOnWall = 0
        timer.after(100, on_after)
        
controller.A.on_event(ControllerButtonEvent.PRESSED, on_a_pressed)

def Pass():
    level[0] = level[0] + 1
    game.splash("Congrats~ you got the goal~ ")
    game.splash("You tried " + str((0 - info.score())) + " times")
    info.set_score(0)
def Tutor():
    global gra
    tiles.set_tilemap(tilemap("""
        level_4
    """))
    gra = 0
    spider.set_position(2, 60)
    game.splash("Welcome to Geometry Dash", "(Fan made)(arcade ver.)")
    game.splash("Now it is a tutorial level")
    
    def on_after2():
        game.splash("Press Button A ", "to lift the spider")
        
        def on_after3():
            game.splash("Then press Button A ", "to let the spider down")
            
            def on_after4():
                game.splash("BE CAREFUL!")
                
                def on_after5():
                    game.splash("You can also press", "Button A in the ring")
                    
                    def on_after6():
                        game.splash("Easy~ Right?", "Let's go~")
                        level[0] = level[0] + 1
                    timer.after(2900, on_after6)
                    
                timer.after(1500, on_after5)
                
            timer.after(1500, on_after4)
            
        timer.after(1500, on_after3)
        
    timer.after(1700, on_after2)
    
def playBgm():
    
    def on_background():
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(415, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(415, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(659, music.beat(BeatFraction.HALF))
        music.play_tone(494, music.beat(BeatFraction.WHOLE))
        music.play_tone(494, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(494, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(494, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(554, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(587, music.beat(BeatFraction.HALF))
        music.play_tone(554, music.beat(BeatFraction.HALF))
        music.play_tone(440, music.beat(BeatFraction.WHOLE))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(415, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(415, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.rest(music.beat(BeatFraction.QUARTER))
        music.play_tone(330, music.beat(BeatFraction.HALF))
        music.play_tone(330, music.beat(BeatFraction.HALF))
        music.play_tone(415, music.beat(BeatFraction.HALF))
        music.play_tone(494, music.beat(BeatFraction.WHOLE))
        music.play_tone(554, music.beat(BeatFraction.QUARTER))
        music.play_tone(494, music.beat(BeatFraction.QUARTER))
        music.play_tone(440, music.beat(BeatFraction.QUARTER))
        music.play_tone(494, music.beat(BeatFraction.QUARTER))
        music.play_tone(494, music.beat(BeatFraction.HALF))
        music.play_tone(440, music.beat(BeatFraction.WHOLE))
        music.rest(music.beat(BeatFraction.HALF))
        playBgm()
    timer.background(on_background)
    
def Retry():
    if level[0] != -1:
        level[0] = 0
        info.change_score_by(-1)
        music.ba_ding.play()
        pause(500)
    else:
        game.reset()
IsOnWall = 0
level: List[number] = []
spider: Sprite = None
ani_of_spider = 0
gra = 0
spider = sprites.create(img("""
        . . . . . . . . . . . . . . . . 
            . . . f f f f f f f f f f f f . 
            . . . f 2 2 2 4 4 f f 2 2 4 f . 
            . . . . f 2 2 4 f 7 7 f 2 f . . 
            . . . . . f 2 4 f 7 7 f 2 f . . 
            . . . . f f 2 4 4 f f 2 f . . . 
            . . f f 2 2 f 4 4 4 2 2 f . . . 
            . f 4 4 f f 2 4 4 4 2 f . . . . 
            f 2 4 f 2 2 f 4 4 4 f 2 f f . . 
            f 2 4 f 2 2 f f f f 2 2 2 4 f . 
            f 2 f 4 2 2 f f 4 4 f f 2 4 f . 
            f 2 f 4 2 f . f 4 4 f . f 4 f . 
            f f 4 4 2 f . f 4 4 f . f 4 f . 
            . . f f f . . . f f . . . f . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . .
    """),
    SpriteKind.player)
info.set_score(1)
level = [-1, 0]
playBgm()
Tutor()

def on_on_update():
    global gra
    if level[0] == 0:
        tiles.set_tilemap(tilemap("""
            level_5
        """))
        gra = 0
        spider.set_position(2, 230)
        level[0] = level[0] + 1
    elif level[0] == 2:
        tiles.set_tilemap(tilemap("""
            level_3
        """))
        scene.set_background_image(img("""
            ................................................................................................................................................................
                        ................................................................................................................................................................
                        ..........88888888.......................................................88888..................................................................................
                        ...8888..888888888...888................................................888888..................................................................................
                        ...888888888888888...888................................................888888..................................................................................
                        ...88888888888888....888................................................8888....................................................................................
                        .....888888888888....888................................................888.....................................................................................
                        ........8888.........888...............88888.....8888...................888.....................................................................................
                        ........888..........888.............88888888....8888...................8888.......88888888....888..888888......................................................
                        ........888..........888888888......8888888888..88888...................888888888..8888888888..88888888888......................................................
                        ........888.........88888888888.....8888888888888888...............88888888888888..8888888888..88888888888......................................................
                        ........888.........88888888888.....888....88888888................88888888888888..888...8888...8888888.................66666...................................
                        ........888.........888888.8888.............888888.................888888888.......888....888...88888...................66666...................................
                        ........888.........8888....888.............88888........................8888......888....888....8888...................66666...................................
                        ........888.........8888....8888...........888888...............6666666..8888......888...8888....888............................................................
                        .......8888........8888.....8888..........8888888...............6666666...888......8888.88888....888...............................................6666.........
                        .......8888........8888.....88888.........8888888...............6666666...8888.....888888888.....888...............................66666.........66666666.......
                        .......888.........8888......8888........88888888888............666.6666..8888.....888888888.....888.............................6666666........6666666666......
                        ...................8888......8888.......88888.888888............666.6666..8888......8888888......888......................666...66666666.......66666666666......
                        ........................................8888...88888............666.6666...888...........................................6666..666666666......6666666.6666......
                        ........................................888....88888............666..666...888..................................666......6666.66666..6666....6666666..6666......
                        ........................................888.....................666..666888888...........................666...6666......6666.6666...6666....666666...6666......
                        ................................................................666..666888888...........................666..66666......666666666....666...6666666...666.......
                        ................................................................666..6668888886666666.........666........666.666666.....666666666.....666...666666...6666.......
                        ......................................................666666....666..666....666666666666......666........6666666666.....66666666......666...66666....6666.......
                        ...................................................6666666666...666.6666...6666666666666.....6666.......66666666666....666666666.....6666..666666....6666.......
                        ..................................................66666666666...666.6666..66666666666666.....6666.......66666666666....66666666......6666..666666...66666...6666
                        .................................................6666666.6666...666.666...666666....6666....6666.......66666666666.....6666666.......6666.666666...666666.666666
                        .................................................66666....666...6666666..666666....66666....6666......66666666.666....66666666.......666..6666666666666666666666
                        ..............................................66666666....666...6666666..666666....66666....6666......6666666..666...66666666........66666666666666666666666666.
                        ..............................................66666666....666...666666...66666.....66666...66666.....66666666..666...66666666........6666666666666666.666666....
                        ..............................................66666666....666...666666..666666.....6666....66666....66666666...666..666666666........66666666........666666.....
                        ...................................................666....666...66666...66666......6666...666666....6666666....666666666.6666.........666666........666666......
                        ...................................................666....666...66666.6666666.....66666..66666666.666666666....66666666..6666......................666666.......
                        ...................................................666....666..6666666666666.....666666..666666666666666666....66666666..666......................666666........
                        ...................................................666....666666666666666666....6666666666666.6666666666666....66666..............................666666........
                        ...................................................666....666666666666666666..66666666666666..666666666666.......................................6666666........
                        ...................................................666....6666666.66666666666666666.6666666...6666..666666......................................66666666........
                        ...................................................666.....66666.........6666666666..66666.........6666666.....................................66666666.........
                        ...................................................666....................666666..................66666666....................................666666666.........
                        ...................................................666...........................................66666.666...................................66666.666..........
                        ...................................................666..........................................666666.666...................................66666.666..........
                        ...................................................666.........................................666666..666..................................6666...666..........
                        ...................................................666........................................666666..6666..................................6666...666..........
                        ...................................................666........................................66666...6666.................................6666....666..........
                        ..................................................6666........................................6666....6666.................................6666....666..........
                        ..................................................6666........................................666....6666..................................666....6666..........
                        ..................................................666.........................................666...66666..................................666....6666..........
                        .................................................6666.........................................66666666666..................................6666.666666..........
                        ............................................666.66666.........................................6666666666...................................6666666666...........
                        ............................................666666666.........................................66666666......................................666666666...........
                        ............................................6666666..........................................................................................666666.............
                        ............................................666666..............................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ......................................................b.........................................................................................................
                        ......................................................b.........................................................................................................
                        ......................................................b.........................................................................................................
                        ......................................................b.........................................................................................................
                        ......................................................b.........................................................................................................
                        ......................................................bbbbb.b...b.......bbbbbbbbbbbbbbbbbb......................................................................
                        ......................................................b...b.b...b......b....bbbbb........bbbbbbbbbbb............................................................
                        ......................................................b...b.b...b..........bb...b......bbb.b.......bbb..........................................................
                        ......................................................b...b.b...b..........b...bb.....bb...b..........bbbb..........bb.bbb......................................
                        ......................................................bbbbb.bbbbb..........bbbb.......bbbbbb...................bbbb.............................................
                        ................................................................b...............................................................................................
                        ................................................................b...............................................................................................
                        ............................................................bbbbb...............................................................................................
        """))
        Pass()
game.on_update(on_on_update)

def on_on_update2():
    scene.center_camera_at(spider.x, spider.y)
    spider.vx = 110
    if IsOnWall == 0:
        if gra == 0:
            spider.vy = 130
        else:
            spider.vy = -150
    else:
        if gra == 0:
            spider.vy = 9999
        else:
            spider.vy = -9999
game.on_update(on_on_update2)

def on_update_interval():
    global ani_of_spider
    ani_of_spider = 1 if ani_of_spider == 0 else 0
    if gra == 0:
        if ani_of_spider == 0:
            spider.set_image(img("""
                . . . . . . . . . . . . . . . . 
                                . . . f f f f f f f f f f f f . 
                                . . . f 2 2 2 4 4 f f 2 2 4 f . 
                                . . . . f 2 2 4 f 7 7 f 2 f . . 
                                . . . . . f 2 4 f 7 7 f 2 f . . 
                                . . . . f f 2 4 4 f f 2 f . . . 
                                . . f f 2 2 f 4 4 4 2 2 f . . . 
                                . f 4 4 f f 2 4 4 4 2 f . . . . 
                                f 2 4 f 2 2 f 4 4 4 f 2 f f . . 
                                f 2 4 f 2 2 f f f f 2 2 2 4 f . 
                                f 2 f 4 2 2 f f 4 4 f f 2 4 f . 
                                f 2 f 4 2 f . f 4 4 f . f 4 f . 
                                f f 4 4 2 f . f 4 4 f . f 4 f . 
                                . . f f f . . . f f . . . f . . 
                                . . . . . . . . . . . . . . . . 
                                . . . . . . . . . . . . . . . .
            """))
        else:
            spider.set_image(img("""
                . . . . . . . . . . . . . . . . 
                                . . . f f f f f f f f f f f f . 
                                . . . f 2 2 2 4 4 f f 2 2 4 f . 
                                . . . . f 2 2 4 f 7 7 f 2 f . . 
                                . . . . . f 2 4 f 7 7 f 2 f . . 
                                . . . . f f 2 4 4 f f 2 f . . . 
                                . . f f 2 2 f 4 4 4 2 2 f . . . 
                                . f 2 4 f f 2 4 4 4 2 f . . . . 
                                . f 2 4 2 2 f 4 4 4 f 2 f f . . 
                                . f 4 f 2 2 f f f f 2 2 2 4 f . 
                                f 2 4 f 2 2 f . f 4 2 f 2 4 4 f 
                                f f f f 2 f . . f 4 2 f f 2 4 f 
                                . f f 4 2 f . . f 4 2 f . f f . 
                                . . f f f . . . . f f . . . . . 
                                . . . . . . . . . . . . . . . . 
                                . . . . . . . . . . . . . . . .
            """))
    else:
        if ani_of_spider == 0:
            spider.set_image(img("""
                . . . . . . . . . . . . . . . . 
                                . . f f f . . . f f . . . f . . 
                                f f 4 4 2 f . f 4 4 f . f 4 f . 
                                f 2 f 4 2 f . f 4 4 f . f 4 f . 
                                f 2 f 4 2 2 f f 4 4 f f 2 4 f . 
                                2 4 f 2 2 f f f f 2 2 2 4 f . . 
                                f 2 4 f 2 2 f 4 4 4 f 2 f f . . 
                                . f 4 4 f f 2 4 4 4 2 f . . . . 
                                . . f f 2 2 f 4 4 4 2 2 f . . . 
                                . . . . f f 2 4 4 f f 2 f . . . 
                                . . . . . f 2 4 f 7 7 f 2 f . . 
                                . . . . f 2 2 4 f 7 7 f 2 f . . 
                                . . . f 2 2 2 4 4 f f 2 2 4 f . 
                                . . . f f f f f f f f f f f f . 
                                . . . . . . . . . . . . . . . . 
                                . . . . . . . . . . . . . . . .
            """))
        else:
            spider.set_image(img("""
                . . . . . . . . . . . . . . . . 
                                . . . f f . . . . f f . . . . . 
                                . . f 4 2 f . . f 4 4 f . f f . 
                                f f f f 2 f . f f 4 2 f f 2 4 f 
                                f 4 4 f 2 f . f 4 4 2 f 2 4 4 f 
                                2 4 4 f 2 f . f f 2 2 f 4 4 f . 
                                f 2 4 4 f f f 4 4 4 f 2 f f . . 
                                f f 2 4 f f 2 4 4 4 2 f . . . . 
                                . . f f 2 2 f 4 4 4 2 2 f . . . 
                                . . . . f f 2 4 4 f f 2 f . . . 
                                . . . . . f 2 4 f 7 7 f 2 f . . 
                                . . . . f 2 2 4 f 7 7 f 2 f . . 
                                . . . f 2 2 2 4 4 f f 2 2 4 f . 
                                . . . f f f f f f f f f f f f . 
                                . . . . . . . . . . . . . . . . 
                                . . . . . . . . . . . . . . . .
            """))
    if spider.is_hitting_tile(CollisionDirection.RIGHT) or (spider.y <= 24 or spider.y >= 1000) or (tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile3) or tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile4)):
        Retry()
    if tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile5) or tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile6) or (tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile7) or tiles.tile_at_location_equals(tiles.get_tile_location(spider.x / 16, spider.y / 16),
        myTiles.tile8)):
        Pass()
game.on_update_interval(100, on_update_interval)

def on_update_interval2():
    spider.start_effect(effects.fire, 300)
game.on_update_interval(300, on_update_interval2)
